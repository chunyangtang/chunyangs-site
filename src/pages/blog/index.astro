---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Get all posts and sort by date (newest first)
const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="Blog | Chunyang">
	<section class="max-w-3xl mx-auto px-4 py-12">
        <h1 class="text-3xl font-bold mb-8 text-gray-900 dark:text-gray-100">Writing</h1>

		{posts.length === 0 ? (
			<p class="rounded-xl border border-gray-100 dark:border-gray-800 bg-white/70 dark:bg-gray-900/60 px-4 py-6 text-gray-600 dark:text-gray-300">
				No posts yet. Check back soon.
			</p>
		) : (
			<div class="space-y-8">
				{posts.map((post) => (
					<a href={`/blog/${post.id.replace(/\/index$/, '')}`} class="block group">
						<article class="flex flex-col md:flex-row gap-4 md:items-baseline border-b border-gray-100 dark:border-gray-800 pb-8 hover:bg-gray-50/50 dark:hover:bg-gray-900/50 -mx-4 px-4 rounded-2xl transition-colors">
							<time datetime={post.data.pubDate.toISOString()} class="text-sm text-gray-400 dark:text-gray-500 font-mono min-w-[100px]">
								{post.data.pubDate.toLocaleDateString(undefined, {
									year: 'numeric',
									month: 'short',
									day: 'numeric'
								})}
							</time>
							<div>
								<h2 class="text-xl font-bold text-gray-900 dark:text-gray-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
									{post.data.title}
								</h2>
								<p class="mt-2 text-gray-600 dark:text-gray-400 leading-relaxed">
									{post.data.description}
								</p>
							</div>
						</article>
					</a>
				))}
			</div>
		)}
	</section>
</Layout>
